# configuration for the ansible provisioner.


# Ansible CFG contents which will be written to a file as toml.
ansiblecfg:
  path: "{{variables:files_path}}/{{variables:files_prefix}}.ansible.cfg"
  contents:
    ssh_connection:
      pipelining: true
      ssh_args: -o ControlMaster=auto -o ControlPersist=30m -o ConnectionAttempts=100 -o UserKnownHostsFile=/dev/null
    defaults:
      host_key_checking: false
      fact_caching: jsonfile
      fact_caching_connection: ./.fact_cache
      fact_caching_timeout: 300
      callback_whitelist: profile_tasks
      deprecation_warnings: false
      inventory_ignore_extension: ~, .orig, .bak, .ini, .cfg, .retry, .pyc, .pyo, .creds

# Anvislbe inventory which will be written to file as flat text.
inventory:
  path: "{{variables:files_path}}/{{variables:files_prefix}}.inventory"
  # here we expect that another process has created an output plugin with the required contents
  # typicall for ansible, a terraform plugin has created the output based on created infra.
  contents: "{{output::ansible_inventory?special::None}}"
